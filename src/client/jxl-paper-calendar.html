<dom-module id="jxl-paper-calendar">

	<style>

	:host {
		display: block;
		width: 330px;
		height: 400px;
		text-align: center;
	}

	.yearHeading
	{
		opacity: 0.84;
		font-size: 1em;
		color: #FFFFFF;
		padding: 2px 8px 2px 8px;
		text-align: left;
	}

	.dateHeading
	{
		font-size: 2.2em;
		color: #FFFFFF;
		padding: 2px 8px 2px 8px;
		text-align: left;
	}

	.headerBackground
	{
		background-color: #2196F3;
		border-top-left-radius:2px;
		border-top-right-radius:2px;
	}

	.wrapperPadding
	{
		padding: 12px;
	}

	.monthHeader
	{
		text-align: center;
	}

	.monthStepper
	{
		height: 44px;
		line-height: 44px;
	}

	.weekdayItem.weekdayItemButton
	{
		padding: 0px;
	}
	.weekdayItem.weekdayItemButton.previousButton
	{
		margin-left: 0px;
	}
	.weekdayItem.weekdayItemButton.nextButton
	{
		margin-right: 0px;
	}

	.weekdayItem
	{
		font-size: 0.8em;
		min-width: 40px;
		max-width: 40px;
		margin: 1px 2px;
		border-radius: 50%;
		width: 40px;
		height: 40px;
		line-height: 40px;
		opacity: 0.54;
	}

	.dayItem, .monthItem, .yearItem
	{
		font-size: 0.8em;
		min-width: 40px;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		margin: 1px 2px;
		cursor: pointer;
		-webkit-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none; /* IE10+ */
		user-select: none;
		line-height: 20px;
	}

	.dayPaperButton
	{
	    background: white;
	    color: black;
	}

	.dayActive
	{
		opacity: 1;
	}

	.dayIsToday
	{
		color: #FF1744;
		background-color: #EEEEEE;
	}

	.dayFade
	{
		opacity: 0.54;
	}

	.calendarBackground
	{
		background-color: #FFFFFF;
		margin-left: 10px;
		margin-right: 10px;
	}

	.marginLeft5
	{
		margin-left: 5px;
	}

	.marginRight5
	{
		margin-right: 5px;
	}

	</style>

	<template>

		<style include="common-styles"></style>

		<paper-material elevation="1">

			<div class="layout vertical headerBackground">
				<div class="wrapperPadding layout vertical">
					<div class="yearHeading">{{getYear(today)}}</div>
					<div class="dateHeading">{{getDateHeader(today)}}</div>
				</div>
			</div>
			<div class="layout vertical calendarBackground">
				<div class="layout horizontal center-center monthStepper">
					<paper-icon-button class="marginLeft5 weekdayItem weekdayItemButton previousButton" icon="hardware:keyboard-arrow-left" on-click="previous"></paper-icon-button>
					<div class="flex monthHeader" >{{getMonth(today)}}</div>
					<paper-icon-button class="marginRight5 weekdayItem weekdayItemButton nextButton" icon="hardware:keyboard-arrow-right" on-click="next"></paper-icon-button>
				</div>
				<div class="layout horizontal">
					<span class="flex weekdayItem">S</span>
					<span class="flex weekdayItem">M</span>
					<span class="flex weekdayItem">T</span>
					<span class="flex weekdayItem">W</span>
					<span class="flex weekdayItem">T</span>
					<span class="flex weekdayItem">F</span>
					<span class="flex weekdayItem">S</span>
				</div>
				<div class="layout horizontal wrap">
					<template is="dom-repeat" items="{{getDays(today)}}">
						<paper-button class$="{{getDayButtonClass(item)}}">{{item.label}}</paper-button>
					</template>
				</div>
			</div>

		</paper-material>

	</template>

	<script>
	Polymer({

		is: "jxl-paper-calendar",

		properties: {

			today: {
				type: Date,
				value: function(){return moment()},
				observer: '_todayChanged'
			}
		},

		_todayChanged: function(newValue, oldValue)
		{
			this.render();
		},

		render: function()
		{

		},

		getYear: function(date)
		{
			return date.year();
		},

		getDateHeader: function(date)
		{
			return date.format("ddd, MMM D");
		},

		getMonth: function(date)
		{
			return date.format("MMMM YYYY")
		},

		getDays: function(date)
		{
			var days = [];
			var start = this.today.clone().startOf('month').day(0);
		   	var end = this.today.clone().endOf('month').day(6);
		   	var month = this.today.month();
		   	var date = this.today.date();
		   	this.type = 'days';
		   	moment()
		   	.range(start, end)
		   	.by('days', function(moment)
		   	{
		   		days.push({
		   			value: moment.format('D'),
		   			label: moment.format('D'),
		   			isToday: moment.date() === date ? ' dayIsToday' : '',
		   			cssClass: moment.month() === month ? 'dayActive': 'dayFade'
		   		});
		   	});
		   	return days;
		},

		getDayButtonClass: function(item)
		{
			return "dayItem dayPaperButton " + item.cssClass + item.isToday;
		},

		previous: function()
		{
			this.today = moment(this.today).hours(-24);
		},

		next: function()
		{
			this.today = moment(this.today).hours(24);
		}

	});

	</script>

</dom-module>